<div th:fragment="modalEditarVenta">
    <div id="modalEditarBackdrop" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden transition-opacity duration-300 ease-out"></div>

    <div id="modalEditarVenta" class="fixed inset-0 flex items-center justify-center p-4 z-50 hidden opacity-0 scale-95 transition-all duration-300 ease-out" role="dialog" aria-modal="true">
        <div class="bg-white rounded-2xl shadow-2xl max-w-6xl w-full p-8 relative animate-fade-in-up">
            <button type="button" onclick="cerrarModalEditarVenta()" class="absolute top-4 right-4 text-gray-600 hover:text-red-600 text-xl">
                <i class="fas fa-times"></i>
            </button>

            <h2 class="text-2xl font-bold mb-6 text-gray-800 text-center">Editar Venta</h2>

            <form id="formEditarVenta" method="post">
                <!-- Datos generales -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Cliente</label>
                        <input type="text" id="editarClienteNombre" class="w-full border border-gray-300 rounded px-3 py-2 bg-gray-100" disabled>
                        <input type="hidden" name="clienteId" id="editarClienteId">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Fecha de Venta</label>
                        <input type="date" name="fechaVenta" id="editarFechaVenta" class="w-full border border-gray-300 rounded px-3 py-2" required>
                    </div>
                </div>

                <!-- Selector para agregar nuevos productos -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Producto</label>
                        <input list="editarListaProductos" id="editarBusquedaProducto" class="w-full border border-gray-300 rounded px-2 py-2" placeholder="Buscar producto..."/>
                        <datalist id="editarListaProductos"></datalist>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Lote</label>
                        <select id="editarLoteSeleccionado" class="w-full border border-gray-300 rounded px-2 py-2"></select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Cantidad</label>
                        <input type="number" id="editarCantidadVenta" min="1" class="w-full border border-gray-300 rounded px-2 py-2"/>
                    </div>

                    <div>
                        <button type="button" onclick="agregarProductoEditarVenta()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded">
                            <i class="fas fa-plus"></i> Agregar
                        </button>
                    </div>
                </div>

                <!-- Tabla editable -->
                <div class="overflow-x-auto rounded-lg border border-gray-200 mb-4">
                    <table class="w-full table-auto text-sm text-left text-gray-700" id="tablaEditarProductosVenta">
                        <thead class="bg-gray-100">
                        <tr>
                            <th class="px-4 py-2 font-semibold">Producto</th>
                            <th class="px-4 py-2 font-semibold">Cantidad</th>
                            <th class="px-4 py-2 font-semibold">Precio Unitario</th>
                            <th class="px-4 py-2 font-semibold">Lote</th>
                            <th class="px-4 py-2 font-semibold text-center">Acci√≥n</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <div class="text-right mt-2 mr-2">
                    <span class="text-lg font-semibold text-gray-700">Subtotal: </span>
                    <span id="editarSubtotalTextoVenta" class="text-lg font-bold text-black-700">$0.00</span>
                </div>

                <!-- Hidden -->
                <input type="hidden" name="usuarioId" th:value="${usuarioId}"/>
                <input type="hidden" name="tipoMovimientoId" value="2"/>

                <div class="flex justify-end mt-6 space-x-2">
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2 rounded shadow">
                        <i class="fas fa-save mr-2"></i> Guardar Cambios
                    </button>
                    <button type="button" onclick="cerrarModalEditarVenta()" class="bg-gray-400 hover:bg-gray-500 text-white font-semibold px-6 py-2 rounded shadow">
                        <i class="fas fa-times-circle mr-2"></i> Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
