<div th:fragment="modalNuevaVenta">
  <div id="modalBackdropVenta" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden transition-opacity duration-300 ease-out" onclick="cerrarModalVenta()"></div>
  <div id="modalNuevaVenta" class="fixed inset-0 flex items-center justify-center p-4 z-50 hidden opacity-0 scale-95 transition-all duration-300 ease-out" role="dialog" aria-modal="true">
    <div class="bg-white rounded-2xl shadow-2xl max-w-5xl w-full p-8 relative animate-fade-in-up">
      <button type="button" onclick="cerrarModalVenta()" class="absolute top-4 right-4 text-gray-600 hover:text-red-600 text-xl">
        <i class="fas fa-times"></i>
      </button>
      <h2 class="text-2xl font-bold mb-6 text-gray-800 text-center">Registrar Nueva Venta</h2>
      <form id="formVenta" th:action="@{/ventas/ventaCompleta}" method="post">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Cliente</label>
            <select name="clienteId" id="clienteId" class="w-full border border-gray-300 rounded px-3 py-2">
              <option value="" disabled selected>Seleccione un cliente</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Fecha de Venta</label>
            <input type="date" name="fechaVenta" id="fechaVenta" class="w-full border border-gray-300 rounded px-3 py-2" required>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 items-end">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Producto</label>
            <input list="listaProductos" id="busquedaProducto" placeholder="Buscar producto..." class="w-full border border-gray-300 rounded px-2 py-2"/>
            <datalist id="listaProductos"></datalist>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Lote</label>
            <select id="loteSeleccionado" class="w-full border border-gray-300 rounded px-2 py-2"></select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Cantidad</label>
            <input type="number" id="cantidadVenta" min="1" class="w-full border border-gray-300 rounded px-2 py-2"/>
          </div>
          <div>
            <button type="button" onclick="agregarProductoVentaManual()" class="w-full bg-blue-600 text-white rounded px-3 py-2 hover:bg-blue-700 transition">
              <i class="fas fa-plus"></i> Agregar Producto
            </button>
          </div>
        </div>

        <div class="overflow-x-auto rounded-lg border border-gray-200">
          <table class="w-full table-auto text-sm text-left text-gray-700" id="tablaProductosVenta">
            <thead class="bg-gray-100">
            <tr>
              <th class="px-4 py-2 font-semibold">Producto</th>
              <th class="px-4 py-2 font-semibold">Cantidad</th>
              <th class="px-4 py-2 font-semibold">Precio Unitario</th>
              <th class="px-4 py-2 font-semibold">Lote</th>
              <th class="px-4 py-2 font-semibold text-center">Acci√≥n</th>
            </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="text-right mt-4 mr-2">
          <span class="text-lg font-semibold text-gray-700">Subtotal: </span>
          <span id="subtotalTextoVenta" class="text-lg font-bold text-black-700">$0.00</span>
        </div>

        <input type="hidden" name="usuarioId" th:value="${usuarioId}"/>
        <input type="hidden" name="tipoMovimientoId" value="2"/>
        <div class="text-right mt-6">
          <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-2 rounded shadow">
            <i class="fas fa-save mr-2"></i> Guardar Venta
          </button>
        </div>
      </form>
    </div>
  </div>
</div>


